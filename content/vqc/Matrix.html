<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<link href="common/css/sf.css" rel="stylesheet" type="text/css"/>
<title>Matrix: Lightweight Complex Matrices</title>
<link href="common/jquery-ui/jquery-ui.css" rel="stylesheet">
<script src="common/jquery-ui/external/jquery/jquery.js"></script>
<script src="common/jquery-ui/jquery-ui.js"></script>
<script src="common/toggleproofs.js"></script>
<link href="common/css/vqc.css" rel="stylesheet" type="text/css"/>
</head>

<body>

<div id="page">

<div id="header">
<div id='logoinheader'><a href='https://softwarefoundations.cis.upenn.edu'>
<img src='common/media/image/sf_logo_sm.png' alt='Software Foundations Logo'></a></div>
<div class='booktitleinheader'><a href='index.html'>Volume Q: Verified Quantum Computing</a></div>
<ul id='menu'>
   <li class='section_name'><a href='toc.html'>Table of Contents</a></li>
   <li class='section_name'><a href='coqindex.html'>Index</a></li>
   <li class='section_name'><a href='deps.html'>Roadmap</a></li>
</ul>
</div>

<div id="main">

<h1 class="libtitle">Matrix<span class="subtitle">Lightweight Complex Matrices</span></h1>


<div class="code code-tight">

<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="http://coq.inria.fr/library/Coq.micromega.Psatz.html#"><span class="id" title="library">Psatz</span></a>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="http://coq.inria.fr/library/Coq.Setoids.Setoid.html#"><span class="id" title="library">Setoid</span></a>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="http://coq.inria.fr/library/Coq.Arith.Arith.html#"><span class="id" title="library">Arith</span></a>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="http://coq.inria.fr/library/Coq.Bool.Bool.html#"><span class="id" title="library">Bool</span></a>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="http://coq.inria.fr/library/Coq.Program.Program.html#"><span class="id" title="library">Program</span></a>.<br/>
<span class="id" title="variable">From</span> <span class="id" title="variable">VQC</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Export</span> <a class="idref" href="Complex.html#"><span class="id" title="library">Complex</span></a>.<br/>
</div>

<div class="doc">
<a name="lab15"></a><h1 class="section">Matrix Definitions and Equivalence</h1>

</div>
<div class="code code-space">

<br/>
<span class="id" title="keyword">Open</span> <span class="id" title="keyword">Scope</span> <span class="id" title="variable">nat_scope</span>.<br/>
</div>

<div class="doc">
We define a <i>matrix</i> as a simple function from to nats
    (corresponding to a row and a column) to a complex number. In many
    contexts it would make sense to parameterize matrices over numeric
    types, but our use case is fairly narrow, so matrices of complex
    numbers will suffice. 
</div>
<div class="code code-tight">

<span class="id" title="keyword">Definition</span> <a name="Matrix"><span class="id" title="definition">Matrix</span></a> (<span class="id" title="variable">m</span> <span class="id" title="variable">n</span> : <a class="idref" href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>) := <a class="idref" href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a> → <a class="idref" href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a> → <a class="idref" href="Complex.html#C"><span class="id" title="definition">C</span></a>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Notation</span> <a name="Vector"><span class="id" title="abbreviation">Vector</span></a> <span class="id" title="variable">n</span> := (<a class="idref" href="Matrix.html#Matrix"><span class="id" title="definition">Matrix</span></a> <span class="id" title="variable">n</span> 1).<br/>
<span class="id" title="keyword">Notation</span> <a name="Square"><span class="id" title="abbreviation">Square</span></a> <span class="id" title="variable">n</span> := (<a class="idref" href="Matrix.html#Matrix"><span class="id" title="definition">Matrix</span></a> <span class="id" title="variable">n</span> <span class="id" title="variable">n</span>).<br/>
</div>

<div class="doc">
Note that the dimensions of the matrix aren't being used here. In
    practice, a matrix is simply a function on any two nats. However,
    we will used these dimensions to define equality, as well as the
    multiplication and kronecker product operations to follow. 
</div>
<div class="code code-tight">

<span class="id" title="keyword">Definition</span> <a name="mat_equiv"><span class="id" title="definition">mat_equiv</span></a> {<span class="id" title="variable">m</span> <span class="id" title="variable">n</span> : <a class="idref" href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>} (<span class="id" title="variable">A</span> <span class="id" title="variable">B</span> : <a class="idref" href="Matrix.html#Matrix"><span class="id" title="definition">Matrix</span></a> <a class="idref" href="Matrix.html#m"><span class="id" title="variable">m</span></a> <a class="idref" href="Matrix.html#n"><span class="id" title="variable">n</span></a>) : <span class="id" title="keyword">Prop</span> := <br/>
&nbsp;&nbsp;<span style='font-size:120%;'>&forall;</span><span class="id" title="variable">i</span> <span class="id" title="variable">j</span>, <a class="idref" href="Matrix.html#i"><span class="id" title="variable">i</span></a> &lt; <a class="idref" href="Matrix.html#m"><span class="id" title="variable">m</span></a> → <a class="idref" href="Matrix.html#j"><span class="id" title="variable">j</span></a> &lt; <a class="idref" href="Matrix.html#n"><span class="id" title="variable">n</span></a> → <a class="idref" href="Matrix.html#A"><span class="id" title="variable">A</span></a> <a class="idref" href="Matrix.html#i"><span class="id" title="variable">i</span></a> <a class="idref" href="Matrix.html#j"><span class="id" title="variable">j</span></a> = <a class="idref" href="Matrix.html#B"><span class="id" title="variable">B</span></a> <a class="idref" href="Matrix.html#i"><span class="id" title="variable">i</span></a> <a class="idref" href="Matrix.html#j"><span class="id" title="variable">j</span></a>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Infix</span> "==" := <a class="idref" href="Matrix.html#mat_equiv"><span class="id" title="definition">mat_equiv</span></a> (<span class="id" title="tactic">at</span> <span class="id" title="variable">level</span> 80).<br/>
</div>

<div class="doc">
Let's prove some important notions about matrix equality. 
</div>
<div class="code code-tight">

<span class="id" title="keyword">Lemma</span> <a name="mat_equiv_refl"><span class="id" title="lemma">mat_equiv_refl</span></a> : <span style='font-size:120%;'>&forall;</span>{<span class="id" title="variable">m</span> <span class="id" title="variable">n</span>} (<span class="id" title="variable">A</span> : <a class="idref" href="Matrix.html#Matrix"><span class="id" title="definition">Matrix</span></a> <a class="idref" href="Matrix.html#m"><span class="id" title="variable">m</span></a> <a class="idref" href="Matrix.html#n"><span class="id" title="variable">n</span></a>), <a class="idref" href="Matrix.html#A"><span class="id" title="variable">A</span></a> == <a class="idref" href="Matrix.html#A"><span class="id" title="variable">A</span></a>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span> <span class="id" title="variable">m</span> <span class="id" title="variable">n</span> <span class="id" title="variable">A</span> <span class="id" title="variable">i</span> <span class="id" title="variable">j</span> <span class="id" title="variable">Hi</span> <span class="id" title="variable">Hj</span>. <span class="id" title="tactic">reflexivity</span>. <span class="id" title="keyword">Qed</span>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Lemma</span> <a name="mat_equiv_sym"><span class="id" title="lemma">mat_equiv_sym</span></a> : <span style='font-size:120%;'>&forall;</span>{<span class="id" title="variable">m</span> <span class="id" title="variable">n</span>} (<span class="id" title="variable">A</span> <span class="id" title="variable">B</span> : <a class="idref" href="Matrix.html#Matrix"><span class="id" title="definition">Matrix</span></a> <a class="idref" href="Matrix.html#m"><span class="id" title="variable">m</span></a> <a class="idref" href="Matrix.html#n"><span class="id" title="variable">n</span></a>), <a class="idref" href="Matrix.html#A"><span class="id" title="variable">A</span></a> == <a class="idref" href="Matrix.html#B"><span class="id" title="variable">B</span></a> → <a class="idref" href="Matrix.html#B"><span class="id" title="variable">B</span></a> == <a class="idref" href="Matrix.html#A"><span class="id" title="variable">A</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="variable">m</span> <span class="id" title="variable">n</span> <span class="id" title="variable">A</span> <span class="id" title="variable">B</span> <span class="id" title="variable">H</span> <span class="id" title="variable">i</span> <span class="id" title="variable">j</span> <span class="id" title="variable">Hi</span> <span class="id" title="variable">Hj</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="variable">H</span>; <span class="id" title="variable">easy</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Lemma</span> <a name="mat_equiv_trans"><span class="id" title="lemma">mat_equiv_trans</span></a> : <span style='font-size:120%;'>&forall;</span>{<span class="id" title="variable">m</span> <span class="id" title="variable">n</span>} (<span class="id" title="variable">A</span> <span class="id" title="variable">B</span> <span class="id" title="variable">C</span> : <a class="idref" href="Matrix.html#Matrix"><span class="id" title="definition">Matrix</span></a> <a class="idref" href="Matrix.html#m"><span class="id" title="variable">m</span></a> <a class="idref" href="Matrix.html#n"><span class="id" title="variable">n</span></a>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Matrix.html#A"><span class="id" title="variable">A</span></a> == <a class="idref" href="Matrix.html#B"><span class="id" title="variable">B</span></a> → <a class="idref" href="Matrix.html#B"><span class="id" title="variable">B</span></a> == <a class="idref" href="Matrix.html#C"><span class="id" title="variable">C</span></a> → <a class="idref" href="Matrix.html#A"><span class="id" title="variable">A</span></a> == <a class="idref" href="Matrix.html#C"><span class="id" title="variable">C</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="variable">m</span> <span class="id" title="variable">n</span> <span class="id" title="variable">A</span> <span class="id" title="variable">B</span> <span class="id" title="variable">C</span> <span class="id" title="variable">HAB</span> <span class="id" title="variable">HBC</span> <span class="id" title="variable">i</span> <span class="id" title="variable">j</span> <span class="id" title="variable">Hi</span> <span class="id" title="variable">Hj</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="variable">HAB</span>; <span class="id" title="tactic">trivial</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="variable">HBC</span>; <span class="id" title="variable">easy</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Add</span> <span class="id" title="variable">Parametric</span> <span class="id" title="variable">Relation</span> <span class="id" title="variable">m</span> <span class="id" title="variable">n</span> : (<a class="idref" href="Matrix.html#Matrix"><span class="id" title="definition">Matrix</span></a> <a class="idref" href="Matrix.html#m"><span class="id" title="variable">m</span></a> <a class="idref" href="Matrix.html#n"><span class="id" title="variable">n</span></a>) (@<a class="idref" href="Matrix.html#mat_equiv"><span class="id" title="definition">mat_equiv</span></a> <a class="idref" href="Matrix.html#m"><span class="id" title="variable">m</span></a> <a class="idref" href="Matrix.html#n"><span class="id" title="variable">n</span></a>)<br/>
&nbsp;&nbsp;<span class="id" title="tactic">reflexivity</span> <span class="id" title="variable">proved</span> <span class="id" title="tactic">by</span> <a class="idref" href="Matrix.html#mat_equiv_refl"><span class="id" title="lemma">mat_equiv_refl</span></a><br/>
&nbsp;&nbsp;<span class="id" title="tactic">symmetry</span> <span class="id" title="variable">proved</span> <span class="id" title="tactic">by</span> <a class="idref" href="Matrix.html#mat_equiv_sym"><span class="id" title="lemma">mat_equiv_sym</span></a><br/>
&nbsp;&nbsp;<span class="id" title="tactic">transitivity</span> <span class="id" title="variable">proved</span> <span class="id" title="tactic">by</span> <a class="idref" href="Matrix.html#mat_equiv_trans"><span class="id" title="lemma">mat_equiv_trans</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">as</span> <span class="id" title="variable">mat_equiv_rel</span>.<br/>
</div>

<div class="doc">
Now we can use matrix equivalence to rewrite! 
</div>
<div class="code code-tight">

<span class="id" title="keyword">Lemma</span> <a name="mat_equiv_trans2"><span class="id" title="lemma">mat_equiv_trans2</span></a> : <span style='font-size:120%;'>&forall;</span>{<span class="id" title="variable">m</span> <span class="id" title="variable">n</span>} (<span class="id" title="variable">A</span> <span class="id" title="variable">B</span> <span class="id" title="variable">C</span> : <a class="idref" href="Matrix.html#Matrix"><span class="id" title="definition">Matrix</span></a> <a class="idref" href="Matrix.html#m"><span class="id" title="variable">m</span></a> <a class="idref" href="Matrix.html#n"><span class="id" title="variable">n</span></a>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Matrix.html#A"><span class="id" title="variable">A</span></a> == <a class="idref" href="Matrix.html#B"><span class="id" title="variable">B</span></a> → <a class="idref" href="Matrix.html#A"><span class="id" title="variable">A</span></a> == <a class="idref" href="Matrix.html#C"><span class="id" title="variable">C</span></a> → <a class="idref" href="Matrix.html#B"><span class="id" title="variable">B</span></a> == <a class="idref" href="Matrix.html#C"><span class="id" title="variable">C</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="variable">m</span> <span class="id" title="variable">n</span> <span class="id" title="variable">A</span> <span class="id" title="variable">B</span> <span class="id" title="variable">C</span> <span class="id" title="variable">HAB</span> <span class="id" title="variable">HAC</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="variable">HAB</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="variable">HAC</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>
</div>

<div class="doc">
<a name="lab16"></a><h1 class="section">Basic Matrices and Operations</h1>

</div>
<div class="code code-space">

<br/>
<span class="id" title="variable">Close</span> <span class="id" title="keyword">Scope</span> <span class="id" title="variable">nat_scope</span>.<br/>
<span class="id" title="keyword">Open</span> <span class="id" title="keyword">Scope</span> <span class="id" title="variable">C_scope</span>.<br/>
</div>

<div class="doc">
Because we will use these so often, it is good to have them in matrix scope. 
</div>
<div class="code code-tight">
<span class="id" title="keyword">Notation</span> "m =? n" := (<a class="idref" href="http://coq.inria.fr/library/Coq.Arith.PeanoNat.html#Nat.eqb"><span class="id" title="definition">Nat.eqb</span></a> <span class="id" title="variable">m</span> <span class="id" title="variable">n</span>) (<span class="id" title="tactic">at</span> <span class="id" title="variable">level</span> 70) : <span class="id" title="variable">matrix_scope</span>.<br/>
<span class="id" title="keyword">Notation</span> "m &lt;? n" := (<a class="idref" href="http://coq.inria.fr/library/Coq.Arith.PeanoNat.html#Nat.ltb"><span class="id" title="definition">Nat.ltb</span></a> <span class="id" title="variable">m</span> <span class="id" title="variable">n</span>) (<span class="id" title="tactic">at</span> <span class="id" title="variable">level</span> 70) : <span class="id" title="variable">matrix_scope</span>.<br/>
<span class="id" title="keyword">Notation</span> "m &lt;=? n" := (<a class="idref" href="http://coq.inria.fr/library/Coq.Arith.PeanoNat.html#Nat.leb"><span class="id" title="definition">Nat.leb</span></a> <span class="id" title="variable">m</span> <span class="id" title="variable">n</span>) (<span class="id" title="tactic">at</span> <span class="id" title="variable">level</span> 70) : <span class="id" title="variable">matrix_scope</span>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Open</span> <span class="id" title="keyword">Scope</span> <span class="id" title="variable">matrix_scope</span>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Definition</span> <a name="I"><span class="id" title="definition">I</span></a> (<span class="id" title="variable">n</span> : <a class="idref" href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>) : <a class="idref" href="Matrix.html#Matrix"><span class="id" title="definition">Matrix</span></a> <a class="idref" href="Matrix.html#n"><span class="id" title="variable">n</span></a> <a class="idref" href="Matrix.html#n"><span class="id" title="variable">n</span></a> := <span class="id" title="keyword">fun</span> <span class="id" title="variable">i</span> <span class="id" title="variable">j</span> ⇒ <span class="id" title="keyword">if</span> (<a class="idref" href="Matrix.html#i"><span class="id" title="variable">i</span></a> =? <a class="idref" href="Matrix.html#j"><span class="id" title="variable">j</span></a>)%<span class="id" title="variable">nat</span> <span class="id" title="keyword">then</span> 1 <span class="id" title="keyword">else</span> 0.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Definition</span> <a name="Zero"><span class="id" title="definition">Zero</span></a> (<span class="id" title="variable">m</span> <span class="id" title="variable">n</span> : <a class="idref" href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>) : <a class="idref" href="Matrix.html#Matrix"><span class="id" title="definition">Matrix</span></a> <a class="idref" href="Matrix.html#m"><span class="id" title="variable">m</span></a> <a class="idref" href="Matrix.html#n"><span class="id" title="variable">n</span></a> := <span class="id" title="keyword">fun</span> <span class="id" title="variable">_</span> <span class="id" title="variable">_</span> ⇒ 0.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Definition</span> <a name="Mscale"><span class="id" title="definition">Mscale</span></a> {<span class="id" title="variable">m</span> <span class="id" title="variable">n</span> : <a class="idref" href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>} (<span class="id" title="variable">c</span> : <a class="idref" href="Complex.html#C"><span class="id" title="definition">C</span></a>) (<span class="id" title="variable">A</span> : <a class="idref" href="Matrix.html#Matrix"><span class="id" title="definition">Matrix</span></a> <a class="idref" href="Matrix.html#m"><span class="id" title="variable">m</span></a> <a class="idref" href="Matrix.html#n"><span class="id" title="variable">n</span></a>) : <a class="idref" href="Matrix.html#Matrix"><span class="id" title="definition">Matrix</span></a> <a class="idref" href="Matrix.html#m"><span class="id" title="variable">m</span></a> <a class="idref" href="Matrix.html#n"><span class="id" title="variable">n</span></a> := <br/>
&nbsp;&nbsp;<span class="id" title="keyword">fun</span> <span class="id" title="variable">i</span> <span class="id" title="variable">j</span> ⇒ <a class="idref" href="Matrix.html#c"><span class="id" title="variable">c</span></a> * <a class="idref" href="Matrix.html#A"><span class="id" title="variable">A</span></a> <a class="idref" href="Matrix.html#i"><span class="id" title="variable">i</span></a> <a class="idref" href="Matrix.html#j"><span class="id" title="variable">j</span></a>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Definition</span> <a name="Mplus"><span class="id" title="definition">Mplus</span></a> {<span class="id" title="variable">m</span> <span class="id" title="variable">n</span> : <a class="idref" href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>} (<span class="id" title="variable">A</span> <span class="id" title="variable">B</span> : <a class="idref" href="Matrix.html#Matrix"><span class="id" title="definition">Matrix</span></a> <a class="idref" href="Matrix.html#m"><span class="id" title="variable">m</span></a> <a class="idref" href="Matrix.html#n"><span class="id" title="variable">n</span></a>) : <a class="idref" href="Matrix.html#Matrix"><span class="id" title="definition">Matrix</span></a> <a class="idref" href="Matrix.html#m"><span class="id" title="variable">m</span></a> <a class="idref" href="Matrix.html#n"><span class="id" title="variable">n</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">fun</span> <span class="id" title="variable">i</span> <span class="id" title="variable">j</span> ⇒ <a class="idref" href="Matrix.html#A"><span class="id" title="variable">A</span></a> <a class="idref" href="Matrix.html#i"><span class="id" title="variable">i</span></a> <a class="idref" href="Matrix.html#j"><span class="id" title="variable">j</span></a> + <a class="idref" href="Matrix.html#B"><span class="id" title="variable">B</span></a> <a class="idref" href="Matrix.html#i"><span class="id" title="variable">i</span></a> <a class="idref" href="Matrix.html#j"><span class="id" title="variable">j</span></a>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Infix</span> ".+" := <a class="idref" href="Matrix.html#Mplus"><span class="id" title="definition">Mplus</span></a> (<span class="id" title="tactic">at</span> <span class="id" title="variable">level</span> 50, <span class="id" title="variable">left</span> <span class="id" title="variable">associativity</span>) : <span class="id" title="variable">matrix_scope</span>.<br/>
<span class="id" title="keyword">Infix</span> ".*" := <a class="idref" href="Matrix.html#Mscale"><span class="id" title="definition">Mscale</span></a> (<span class="id" title="tactic">at</span> <span class="id" title="variable">level</span> 40, <span class="id" title="variable">left</span> <span class="id" title="variable">associativity</span>) : <span class="id" title="variable">matrix_scope</span>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Lemma</span> <a name="Mplus_assoc"><span class="id" title="lemma">Mplus_assoc</span></a> : <span style='font-size:120%;'>&forall;</span>{<span class="id" title="variable">m</span> <span class="id" title="variable">n</span>} (<span class="id" title="variable">A</span> <span class="id" title="variable">B</span> <span class="id" title="variable">C</span> : <a class="idref" href="Matrix.html#Matrix"><span class="id" title="definition">Matrix</span></a> <a class="idref" href="Matrix.html#m"><span class="id" title="variable">m</span></a> <a class="idref" href="Matrix.html#n"><span class="id" title="variable">n</span></a>), (<a class="idref" href="Matrix.html#A"><span class="id" title="variable">A</span></a> .+ <a class="idref" href="Matrix.html#B"><span class="id" title="variable">B</span></a>) .+ <a class="idref" href="Matrix.html#C"><span class="id" title="variable">C</span></a> == <a class="idref" href="Matrix.html#A"><span class="id" title="variable">A</span></a> .+ (<a class="idref" href="Matrix.html#B"><span class="id" title="variable">B</span></a> .+ <a class="idref" href="Matrix.html#C"><span class="id" title="variable">C</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="variable">m</span> <span class="id" title="variable">n</span> <span class="id" title="variable">A</span> <span class="id" title="variable">B</span> <span class="id" title="variable">C</span> <span class="id" title="variable">i</span> <span class="id" title="variable">j</span> <span class="id" title="variable">Hi</span> <span class="id" title="variable">Hj</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="Matrix.html#Mplus"><span class="id" title="definition">Mplus</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="variable">lca</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Lemma</span> <a name="Mplus_comm"><span class="id" title="lemma">Mplus_comm</span></a> : <span style='font-size:120%;'>&forall;</span>{<span class="id" title="variable">m</span> <span class="id" title="variable">n</span>} (<span class="id" title="variable">A</span> <span class="id" title="variable">B</span> : <a class="idref" href="Matrix.html#Matrix"><span class="id" title="definition">Matrix</span></a> <a class="idref" href="Matrix.html#m"><span class="id" title="variable">m</span></a> <a class="idref" href="Matrix.html#n"><span class="id" title="variable">n</span></a>), <a class="idref" href="Matrix.html#A"><span class="id" title="variable">A</span></a> .+ <a class="idref" href="Matrix.html#B"><span class="id" title="variable">B</span></a> == <a class="idref" href="Matrix.html#B"><span class="id" title="variable">B</span></a> .+ <a class="idref" href="Matrix.html#A"><span class="id" title="variable">A</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;WORKED&nbsp;IN&nbsp;CLASS&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="variable">m</span> <span class="id" title="variable">n</span> <span class="id" title="variable">A</span> <span class="id" title="variable">B</span> <span class="id" title="variable">i</span> <span class="id" title="variable">j</span> <span class="id" title="variable">Hi</span> <span class="id" title="variable">Hj</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="Matrix.html#Mplus"><span class="id" title="definition">Mplus</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="variable">lca</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Lemma</span> <a name="Mplus_0_l"><span class="id" title="lemma">Mplus_0_l</span></a> : <span style='font-size:120%;'>&forall;</span>{<span class="id" title="variable">m</span> <span class="id" title="variable">n</span>} (<span class="id" title="variable">A</span> : <a class="idref" href="Matrix.html#Matrix"><span class="id" title="definition">Matrix</span></a> <a class="idref" href="Matrix.html#m"><span class="id" title="variable">m</span></a> <a class="idref" href="Matrix.html#n"><span class="id" title="variable">n</span></a>), <a class="idref" href="Matrix.html#Zero"><span class="id" title="definition">Zero</span></a> <a class="idref" href="Matrix.html#m"><span class="id" title="variable">m</span></a> <a class="idref" href="Matrix.html#n"><span class="id" title="variable">n</span></a> .+ <a class="idref" href="Matrix.html#A"><span class="id" title="variable">A</span></a> == <a class="idref" href="Matrix.html#A"><span class="id" title="variable">A</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;WORKED&nbsp;IN&nbsp;CLASS&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="variable">m</span> <span class="id" title="variable">n</span> <span class="id" title="variable">A</span> <span class="id" title="variable">i</span> <span class="id" title="variable">j</span> <span class="id" title="variable">Hi</span> <span class="id" title="variable">Hj</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="Matrix.html#Zero"><span class="id" title="definition">Zero</span></a>, <a class="idref" href="Matrix.html#Mplus"><span class="id" title="definition">Mplus</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="variable">lca</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/><hr class='doublespaceincode'/>
<span class="comment">(*&nbsp;Let's&nbsp;try&nbsp;one&nbsp;without&nbsp;unfolding&nbsp;definitions.&nbsp;*)</span><br/>
<span class="id" title="keyword">Lemma</span> <a name="Mplus_0_r"><span class="id" title="lemma">Mplus_0_r</span></a> : <span style='font-size:120%;'>&forall;</span>{<span class="id" title="variable">m</span> <span class="id" title="variable">n</span>} (<span class="id" title="variable">A</span> : <a class="idref" href="Matrix.html#Matrix"><span class="id" title="definition">Matrix</span></a> <a class="idref" href="Matrix.html#m"><span class="id" title="variable">m</span></a> <a class="idref" href="Matrix.html#n"><span class="id" title="variable">n</span></a>), <a class="idref" href="Matrix.html#A"><span class="id" title="variable">A</span></a> .+ <a class="idref" href="Matrix.html#Zero"><span class="id" title="definition">Zero</span></a> <a class="idref" href="Matrix.html#m"><span class="id" title="variable">m</span></a> <a class="idref" href="Matrix.html#n"><span class="id" title="variable">n</span></a> == <a class="idref" href="Matrix.html#A"><span class="id" title="variable">A</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;WORKED&nbsp;IN&nbsp;CLASS&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="variable">m</span> <span class="id" title="variable">n</span> <span class="id" title="variable">A</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="Matrix.html#Mplus_comm"><span class="id" title="lemma">Mplus_comm</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="Matrix.html#Mplus_0_l"><span class="id" title="lemma">Mplus_0_l</span></a>.<br/>
<span class="id" title="keyword">Qed</span>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Lemma</span> <a name="Mplus3_first_try"><span class="id" title="lemma">Mplus3_first_try</span></a> : <span style='font-size:120%;'>&forall;</span>{<span class="id" title="variable">m</span> <span class="id" title="variable">n</span>} (<span class="id" title="variable">A</span> <span class="id" title="variable">B</span> <span class="id" title="variable">C</span> : <a class="idref" href="Matrix.html#Matrix"><span class="id" title="definition">Matrix</span></a> <a class="idref" href="Matrix.html#m"><span class="id" title="variable">m</span></a> <a class="idref" href="Matrix.html#n"><span class="id" title="variable">n</span></a>), (<a class="idref" href="Matrix.html#B"><span class="id" title="variable">B</span></a> .+ <a class="idref" href="Matrix.html#A"><span class="id" title="variable">A</span></a>) .+ <a class="idref" href="Matrix.html#C"><span class="id" title="variable">C</span></a> == <a class="idref" href="Matrix.html#A"><span class="id" title="variable">A</span></a> .+ (<a class="idref" href="Matrix.html#B"><span class="id" title="variable">B</span></a> .+ <a class="idref" href="Matrix.html#C"><span class="id" title="variable">C</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;WORKED&nbsp;IN&nbsp;CLASS&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="variable">m</span> <span class="id" title="variable">n</span> <span class="id" title="variable">A</span> <span class="id" title="variable">B</span> <span class="id" title="variable">C</span>.<br/>
&nbsp;&nbsp;<span class="id" title="variable">Fail</span> <span class="id" title="tactic">rewrite</span> (<a class="idref" href="Matrix.html#Mplus_comm"><span class="id" title="lemma">Mplus_comm</span></a> <span class="id" title="variable">B</span> <span class="id" title="variable">A</span>).<br/>
<span class="id" title="keyword">Abort</span>.<br/>
</div>

<div class="doc">
What went wrong? While we can rewrite using <span class="inlinecode">==</span>, we don't
    know that <span class="inlinecode">.+</span> <i>respects</i> <span class="inlinecode">==</span>. That is, we don't know that if 
    <span class="inlinecode"><span class="id" title="variable">A</span></span> <span class="inlinecode">==</span> <span class="inlinecode"><span class="id" title="variable">A'</span></span> and <span class="inlinecode"><span class="id" title="variable">B</span></span> <span class="inlinecode">==</span> <span class="inlinecode"><span class="id" title="variable">B'</span></span> then <span class="inlinecode"><span class="id" title="variable">A</span></span> <span class="inlinecode">.+</span> <span class="inlinecode"><span class="id" title="variable">B</span></span> <span class="inlinecode">==</span> <span class="inlinecode"><span class="id" title="variable">A'</span></span> <span class="inlinecode">.+</span> <span class="inlinecode"><span class="id" title="variable">B'</span></span> &mdash; or at least, we
    haven't told Coq that.

<div class="paragraph"> </div>

   Let's take a look at an example of a unary function that doesn't
   respect <span class="inlinecode">==</span> 
</div>
<div class="code code-tight">

<span class="id" title="keyword">Definition</span> <a name="shift_right"><span class="id" title="definition">shift_right</span></a> {<span class="id" title="variable">m</span> <span class="id" title="variable">n</span>} (<span class="id" title="variable">A</span> : <a class="idref" href="Matrix.html#Matrix"><span class="id" title="definition">Matrix</span></a> <a class="idref" href="Matrix.html#m"><span class="id" title="variable">m</span></a> <a class="idref" href="Matrix.html#n"><span class="id" title="variable">n</span></a>) (<span class="id" title="variable">k</span> : <a class="idref" href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>) : <a class="idref" href="Matrix.html#Matrix"><span class="id" title="definition">Matrix</span></a> <a class="idref" href="Matrix.html#m"><span class="id" title="variable">m</span></a> <a class="idref" href="Matrix.html#n"><span class="id" title="variable">n</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">fun</span> <span class="id" title="variable">i</span> <span class="id" title="variable">j</span> ⇒ <a class="idref" href="Matrix.html#A"><span class="id" title="variable">A</span></a> <a class="idref" href="Matrix.html#i"><span class="id" title="variable">i</span></a> (<a class="idref" href="Matrix.html#j"><span class="id" title="variable">j</span></a> + <a class="idref" href="Matrix.html#k"><span class="id" title="variable">k</span></a>)%<span class="id" title="variable">nat</span>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Lemma</span> <a name="shift_unequal"><span class="id" title="lemma">shift_unequal</span></a> : <span style='font-size:120%;'>&exist;</span><span class="id" title="variable">m</span> <span class="id" title="variable">n</span> (<span class="id" title="variable">A</span> <span class="id" title="variable">A'</span> : <a class="idref" href="Matrix.html#Matrix"><span class="id" title="definition">Matrix</span></a> <a class="idref" href="Matrix.html#m"><span class="id" title="variable">m</span></a> <a class="idref" href="Matrix.html#n"><span class="id" title="variable">n</span></a>) (<span class="id" title="variable">k</span> : <a class="idref" href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Matrix.html#A"><span class="id" title="variable">A</span></a> == <a class="idref" href="Matrix.html#A'"><span class="id" title="variable">A'</span></a> ∧ ¬(<a class="idref" href="Matrix.html#shift_right"><span class="id" title="definition">shift_right</span></a> <a class="idref" href="Matrix.html#A"><span class="id" title="variable">A</span></a> <a class="idref" href="Matrix.html#k"><span class="id" title="variable">k</span></a> == <a class="idref" href="Matrix.html#shift_right"><span class="id" title="definition">shift_right</span></a> <a class="idref" href="Matrix.html#A'"><span class="id" title="variable">A'</span></a> <a class="idref" href="Matrix.html#k"><span class="id" title="variable">k</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="variable">A</span> := (<span class="id" title="keyword">fun</span> <span class="id" title="variable">i</span> <span class="id" title="variable">j</span> ⇒ <span class="id" title="keyword">if</span> (<a class="idref" href="Matrix.html#j"><span class="id" title="variable">j</span></a> &lt;? 2)%<span class="id" title="variable">nat</span> <span class="id" title="keyword">then</span> 1 <span class="id" title="keyword">else</span> 0) : <a class="idref" href="Matrix.html#Matrix"><span class="id" title="definition">Matrix</span></a> 2 2).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="variable">A'</span> := (<span class="id" title="keyword">fun</span> <span class="id" title="variable">i</span> <span class="id" title="variable">j</span> ⇒ <span class="id" title="keyword">if</span> (<a class="idref" href="Matrix.html#j"><span class="id" title="variable">j</span></a> &lt;? 3)%<span class="id" title="variable">nat</span> <span class="id" title="keyword">then</span> 1 <span class="id" title="keyword">else</span> 0) : <a class="idref" href="Matrix.html#Matrix"><span class="id" title="definition">Matrix</span></a> 2 2).<br/>
&nbsp;&nbsp;<span style='font-size:120%;'>&exist;</span><span class="id" title="variable">_</span>, <span class="id" title="variable">_</span>, <span class="id" title="variable">A</span>, <span class="id" title="variable">A'</span>, 1%<span class="id" title="variable">nat</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intros</span> <span class="id" title="variable">i</span> <span class="id" title="variable">j</span> <span class="id" title="variable">Hi</span> <span class="id" title="variable">Hj</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="variable">A</span>, <span class="id" title="variable">A'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="variable">j</span> <span class="id" title="keyword">as</span> [|[|]]; <span class="id" title="tactic">destruct</span> <span class="id" title="variable">i</span> <span class="id" title="keyword">as</span> [|[|]]; <span class="id" title="tactic">trivial</span>; <span class="id" title="variable">lia</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intros</span> <span class="id" title="variable">F</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (1 &lt; 2)%<span class="id" title="variable">nat</span> <span class="id" title="tactic">by</span> <span class="id" title="variable">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="variable">specialize</span> (<span class="id" title="variable">F</span> <span class="id" title="variable">_</span> <span class="id" title="variable">_</span> <span class="id" title="variable">H</span> <span class="id" title="variable">H</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="variable">A</span>, <span class="id" title="variable">A'</span>, <a class="idref" href="Matrix.html#shift_right"><span class="id" title="definition">shift_right</span></a> <span class="id" title="keyword">in</span> <span class="id" title="variable">F</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span> <span class="id" title="keyword">in</span> <span class="id" title="variable">F</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="variable">F</span>; <span class="id" title="variable">lra</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>
</div>

<div class="doc">
Let's show that <span class="inlinecode">.+</span> does respect <span class="inlinecode">==</span> 
</div>
<div class="code code-tight">

<span class="id" title="keyword">Lemma</span> <a name="Mplus_compat"><span class="id" title="lemma">Mplus_compat</span></a> : <span style='font-size:120%;'>&forall;</span>{<span class="id" title="variable">m</span> <span class="id" title="variable">n</span>} (<span class="id" title="variable">A</span> <span class="id" title="variable">B</span> <span class="id" title="variable">A'</span> <span class="id" title="variable">B'</span> : <a class="idref" href="Matrix.html#Matrix"><span class="id" title="definition">Matrix</span></a> <a class="idref" href="Matrix.html#m"><span class="id" title="variable">m</span></a> <a class="idref" href="Matrix.html#n"><span class="id" title="variable">n</span></a>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Matrix.html#A"><span class="id" title="variable">A</span></a> == <a class="idref" href="Matrix.html#A'"><span class="id" title="variable">A'</span></a> → <a class="idref" href="Matrix.html#B"><span class="id" title="variable">B</span></a> == <a class="idref" href="Matrix.html#B'"><span class="id" title="variable">B'</span></a> → <a class="idref" href="Matrix.html#A"><span class="id" title="variable">A</span></a> .+ <a class="idref" href="Matrix.html#B"><span class="id" title="variable">B</span></a> == <a class="idref" href="Matrix.html#A'"><span class="id" title="variable">A'</span></a> .+ <a class="idref" href="Matrix.html#B'"><span class="id" title="variable">B'</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;WORKED&nbsp;IN&nbsp;CLASS&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="variable">m</span> <span class="id" title="variable">n</span> <span class="id" title="variable">A</span> <span class="id" title="variable">B</span> <span class="id" title="variable">A'</span> <span class="id" title="variable">B'</span> <span class="id" title="variable">HA</span> <span class="id" title="variable">HB</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="variable">i</span> <span class="id" title="variable">j</span> <span class="id" title="variable">Hi</span> <span class="id" title="variable">Hj</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="Matrix.html#Mplus"><span class="id" title="definition">Mplus</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="variable">HA</span> <span class="id" title="tactic">by</span> <span class="id" title="variable">lia</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="variable">HB</span> <span class="id" title="tactic">by</span> <span class="id" title="variable">lia</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">reflexivity</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Add</span> <span class="id" title="variable">Parametric</span> <span class="id" title="variable">Morphism</span> <span class="id" title="variable">m</span> <span class="id" title="variable">n</span> : (@<a class="idref" href="Matrix.html#Mplus"><span class="id" title="definition">Mplus</span></a> <a class="idref" href="Matrix.html#m"><span class="id" title="variable">m</span></a> <a class="idref" href="Matrix.html#n"><span class="id" title="variable">n</span></a>)<br/>
&nbsp;&nbsp;<span class="id" title="keyword">with</span> <span class="id" title="variable">signature</span> <a class="idref" href="Matrix.html#mat_equiv"><span class="id" title="definition">mat_equiv</span></a> ==&gt; <a class="idref" href="Matrix.html#mat_equiv"><span class="id" title="definition">mat_equiv</span></a> ==&gt; <a class="idref" href="Matrix.html#mat_equiv"><span class="id" title="definition">mat_equiv</span></a> <span class="id" title="keyword">as</span> <span class="id" title="variable">Mplus_mor</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="variable">A</span> <span class="id" title="variable">A'</span> <span class="id" title="variable">HA</span> <span class="id" title="variable">B</span> <span class="id" title="variable">B'</span> <span class="id" title="variable">HB</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="Matrix.html#Mplus_compat"><span class="id" title="lemma">Mplus_compat</span></a>; <span class="id" title="variable">easy</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>
</div>

<div class="doc">
Now let's return to that lemma... 
</div>
<div class="code code-tight">

<span class="id" title="keyword">Lemma</span> <a name="Mplus3"><span class="id" title="lemma">Mplus3</span></a> : <span style='font-size:120%;'>&forall;</span>{<span class="id" title="variable">m</span> <span class="id" title="variable">n</span>} (<span class="id" title="variable">A</span> <span class="id" title="variable">B</span> <span class="id" title="variable">C</span> : <a class="idref" href="Matrix.html#Matrix"><span class="id" title="definition">Matrix</span></a> <a class="idref" href="Matrix.html#m"><span class="id" title="variable">m</span></a> <a class="idref" href="Matrix.html#n"><span class="id" title="variable">n</span></a>), (<a class="idref" href="Matrix.html#B"><span class="id" title="variable">B</span></a> .+ <a class="idref" href="Matrix.html#A"><span class="id" title="variable">A</span></a>) .+ <a class="idref" href="Matrix.html#C"><span class="id" title="variable">C</span></a> == <a class="idref" href="Matrix.html#A"><span class="id" title="variable">A</span></a> .+ (<a class="idref" href="Matrix.html#B"><span class="id" title="variable">B</span></a> .+ <a class="idref" href="Matrix.html#C"><span class="id" title="variable">C</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;WORKED&nbsp;IN&nbsp;CLASS&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="variable">m</span> <span class="id" title="variable">n</span> <span class="id" title="variable">A</span> <span class="id" title="variable">B</span> <span class="id" title="variable">C</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<a class="idref" href="Matrix.html#Mplus_comm"><span class="id" title="lemma">Mplus_comm</span></a> <span class="id" title="variable">B</span> <span class="id" title="variable">A</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="Matrix.html#Mplus_assoc"><span class="id" title="lemma">Mplus_assoc</span></a>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>
</div>

<div class="doc">
Mscale is similarly compatible with <span class="inlinecode">==</span>, but requires a slightly
    different lemma: 
</div>
<div class="code code-tight">

<span class="id" title="keyword">Lemma</span> <a name="Mscale_compat"><span class="id" title="lemma">Mscale_compat</span></a> : <span style='font-size:120%;'>&forall;</span>{<span class="id" title="variable">m</span> <span class="id" title="variable">n</span>} (<span class="id" title="variable">c</span> <span class="id" title="variable">c'</span> : <a class="idref" href="Complex.html#C"><span class="id" title="definition">C</span></a>) (<span class="id" title="variable">A</span> <span class="id" title="variable">A'</span> : <a class="idref" href="Matrix.html#Matrix"><span class="id" title="definition">Matrix</span></a> <a class="idref" href="Matrix.html#m"><span class="id" title="variable">m</span></a> <a class="idref" href="Matrix.html#n"><span class="id" title="variable">n</span></a>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Matrix.html#c"><span class="id" title="variable">c</span></a> = <a class="idref" href="Matrix.html#c'"><span class="id" title="variable">c'</span></a> → <a class="idref" href="Matrix.html#A"><span class="id" title="variable">A</span></a> == <a class="idref" href="Matrix.html#A'"><span class="id" title="variable">A'</span></a> → <a class="idref" href="Matrix.html#c"><span class="id" title="variable">c</span></a> .* <a class="idref" href="Matrix.html#A"><span class="id" title="variable">A</span></a> == <a class="idref" href="Matrix.html#c'"><span class="id" title="variable">c'</span></a> .* <a class="idref" href="Matrix.html#A'"><span class="id" title="variable">A'</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="variable">m</span> <span class="id" title="variable">n</span> <span class="id" title="variable">c</span> <span class="id" title="variable">c'</span> <span class="id" title="variable">A</span> <span class="id" title="variable">A'</span> <span class="id" title="variable">Hc</span> <span class="id" title="variable">HA</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="variable">i</span> <span class="id" title="variable">j</span> <span class="id" title="variable">Hi</span> <span class="id" title="variable">Hj</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="Matrix.html#Mscale"><span class="id" title="definition">Mscale</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="variable">Hc</span>, <span class="id" title="variable">HA</span>; <span class="id" title="variable">easy</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Add</span> <span class="id" title="variable">Parametric</span> <span class="id" title="variable">Morphism</span> <span class="id" title="variable">m</span> <span class="id" title="variable">n</span> : (@<a class="idref" href="Matrix.html#Mscale"><span class="id" title="definition">Mscale</span></a> <a class="idref" href="Matrix.html#m"><span class="id" title="variable">m</span></a> <a class="idref" href="Matrix.html#n"><span class="id" title="variable">n</span></a>)<br/>
&nbsp;&nbsp;<span class="id" title="keyword">with</span> <span class="id" title="variable">signature</span> <a class="idref" href="http://coq.inria.fr/library/Coq.Init.Logic.html#eq"><span class="id" title="inductive">eq</span></a> ==&gt; <a class="idref" href="Matrix.html#mat_equiv"><span class="id" title="definition">mat_equiv</span></a> ==&gt; <a class="idref" href="Matrix.html#mat_equiv"><span class="id" title="definition">mat_equiv</span></a> <span class="id" title="keyword">as</span> <span class="id" title="variable">Mscale_mor</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>; <span class="id" title="tactic">apply</span> <a class="idref" href="Matrix.html#Mscale_compat"><span class="id" title="lemma">Mscale_compat</span></a>; <span class="id" title="variable">easy</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>
</div>

<div class="doc">
Let's move on to the more interesting matrix functions: 
</div>
<div class="code code-tight">

<span class="id" title="keyword">Definition</span> <a name="trace"><span class="id" title="definition">trace</span></a> {<span class="id" title="variable">n</span> : <a class="idref" href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>} (<span class="id" title="variable">A</span> : <a class="idref" href="Matrix.html#Square"><span class="id" title="abbreviation">Square</span></a> <a class="idref" href="Matrix.html#n"><span class="id" title="variable">n</span></a>) : <a class="idref" href="Complex.html#C"><span class="id" title="definition">C</span></a> := <br/>
&nbsp;&nbsp;<a class="idref" href="Complex.html#Csum"><span class="id" title="definition">Csum</span></a> (<span class="id" title="keyword">fun</span> <span class="id" title="variable">x</span> ⇒ <a class="idref" href="Matrix.html#A"><span class="id" title="variable">A</span></a> <a class="idref" href="Matrix.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="Matrix.html#x"><span class="id" title="variable">x</span></a>) <a class="idref" href="Matrix.html#n"><span class="id" title="variable">n</span></a>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Definition</span> <a name="Mmult"><span class="id" title="definition">Mmult</span></a> {<span class="id" title="variable">m</span> <span class="id" title="variable">n</span> <span class="id" title="variable">o</span> : <a class="idref" href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>} (<span class="id" title="variable">A</span> : <a class="idref" href="Matrix.html#Matrix"><span class="id" title="definition">Matrix</span></a> <a class="idref" href="Matrix.html#m"><span class="id" title="variable">m</span></a> <a class="idref" href="Matrix.html#n"><span class="id" title="variable">n</span></a>) (<span class="id" title="variable">B</span> : <a class="idref" href="Matrix.html#Matrix"><span class="id" title="definition">Matrix</span></a> <a class="idref" href="Matrix.html#n"><span class="id" title="variable">n</span></a> <a class="idref" href="Matrix.html#o"><span class="id" title="variable">o</span></a>) : <a class="idref" href="Matrix.html#Matrix"><span class="id" title="definition">Matrix</span></a> <a class="idref" href="Matrix.html#m"><span class="id" title="variable">m</span></a> <a class="idref" href="Matrix.html#o"><span class="id" title="variable">o</span></a> := <br/>
&nbsp;&nbsp;<span class="id" title="keyword">fun</span> <span class="id" title="variable">x</span> <span class="id" title="variable">z</span> ⇒ <a class="idref" href="Complex.html#Csum"><span class="id" title="definition">Csum</span></a> (<span class="id" title="keyword">fun</span> <span class="id" title="variable">y</span> ⇒ <a class="idref" href="Matrix.html#A"><span class="id" title="variable">A</span></a> <a class="idref" href="Matrix.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="Matrix.html#y"><span class="id" title="variable">y</span></a> * <a class="idref" href="Matrix.html#B"><span class="id" title="variable">B</span></a> <a class="idref" href="Matrix.html#y"><span class="id" title="variable">y</span></a> <a class="idref" href="Matrix.html#z"><span class="id" title="variable">z</span></a>) <a class="idref" href="Matrix.html#n"><span class="id" title="variable">n</span></a>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Open</span> <span class="id" title="keyword">Scope</span> <span class="id" title="variable">nat_scope</span>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Definition</span> <a name="kron"><span class="id" title="definition">kron</span></a> {<span class="id" title="variable">m</span> <span class="id" title="variable">n</span> <span class="id" title="variable">o</span> <span class="id" title="variable">p</span> : <a class="idref" href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>} (<span class="id" title="variable">A</span> : <a class="idref" href="Matrix.html#Matrix"><span class="id" title="definition">Matrix</span></a> <a class="idref" href="Matrix.html#m"><span class="id" title="variable">m</span></a> <a class="idref" href="Matrix.html#n"><span class="id" title="variable">n</span></a>) (<span class="id" title="variable">B</span> : <a class="idref" href="Matrix.html#Matrix"><span class="id" title="definition">Matrix</span></a> <a class="idref" href="Matrix.html#o"><span class="id" title="variable">o</span></a> <a class="idref" href="Matrix.html#p"><span class="id" title="variable">p</span></a>) : <br/>
&nbsp;&nbsp;<a class="idref" href="Matrix.html#Matrix"><span class="id" title="definition">Matrix</span></a> (<a class="idref" href="Matrix.html#m"><span class="id" title="variable">m</span></a>*<a class="idref" href="Matrix.html#o"><span class="id" title="variable">o</span></a>) (<a class="idref" href="Matrix.html#n"><span class="id" title="variable">n</span></a>*<a class="idref" href="Matrix.html#p"><span class="id" title="variable">p</span></a>) :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">fun</span> <span class="id" title="variable">x</span> <span class="id" title="variable">y</span> ⇒ <a class="idref" href="Complex.html#Cmult"><span class="id" title="definition">Cmult</span></a> (<a class="idref" href="Matrix.html#A"><span class="id" title="variable">A</span></a> (<a class="idref" href="Matrix.html#x"><span class="id" title="variable">x</span></a> / <a class="idref" href="Matrix.html#o"><span class="id" title="variable">o</span></a>) (<a class="idref" href="Matrix.html#y"><span class="id" title="variable">y</span></a> / <a class="idref" href="Matrix.html#p"><span class="id" title="variable">p</span></a>)) (<a class="idref" href="Matrix.html#B"><span class="id" title="variable">B</span></a> (<a class="idref" href="Matrix.html#x"><span class="id" title="variable">x</span></a> <span class="id" title="variable">mod</span> <a class="idref" href="Matrix.html#o"><span class="id" title="variable">o</span></a>) (<a class="idref" href="Matrix.html#y"><span class="id" title="variable">y</span></a> <span class="id" title="variable">mod</span> <a class="idref" href="Matrix.html#p"><span class="id" title="variable">p</span></a>)).<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Definition</span> <a name="transpose"><span class="id" title="definition">transpose</span></a> {<span class="id" title="variable">m</span> <span class="id" title="variable">n</span>} (<span class="id" title="variable">A</span> : <a class="idref" href="Matrix.html#Matrix"><span class="id" title="definition">Matrix</span></a> <a class="idref" href="Matrix.html#m"><span class="id" title="variable">m</span></a> <a class="idref" href="Matrix.html#n"><span class="id" title="variable">n</span></a>) : <a class="idref" href="Matrix.html#Matrix"><span class="id" title="definition">Matrix</span></a> <a class="idref" href="Matrix.html#n"><span class="id" title="variable">n</span></a> <a class="idref" href="Matrix.html#m"><span class="id" title="variable">m</span></a> := <br/>
&nbsp;&nbsp;<span class="id" title="keyword">fun</span> <span class="id" title="variable">x</span> <span class="id" title="variable">y</span> ⇒ <a class="idref" href="Matrix.html#A"><span class="id" title="variable">A</span></a> <a class="idref" href="Matrix.html#y"><span class="id" title="variable">y</span></a> <a class="idref" href="Matrix.html#x"><span class="id" title="variable">x</span></a>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Definition</span> <a name="adjoint"><span class="id" title="definition">adjoint</span></a> {<span class="id" title="variable">m</span> <span class="id" title="variable">n</span>} (<span class="id" title="variable">A</span> : <a class="idref" href="Matrix.html#Matrix"><span class="id" title="definition">Matrix</span></a> <a class="idref" href="Matrix.html#m"><span class="id" title="variable">m</span></a> <a class="idref" href="Matrix.html#n"><span class="id" title="variable">n</span></a>) : <a class="idref" href="Matrix.html#Matrix"><span class="id" title="definition">Matrix</span></a> <a class="idref" href="Matrix.html#n"><span class="id" title="variable">n</span></a> <a class="idref" href="Matrix.html#m"><span class="id" title="variable">m</span></a> := <br/>
&nbsp;&nbsp;<span class="id" title="keyword">fun</span> <span class="id" title="variable">x</span> <span class="id" title="variable">y</span> ⇒ (<a class="idref" href="Matrix.html#A"><span class="id" title="variable">A</span></a> <a class="idref" href="Matrix.html#y"><span class="id" title="variable">y</span></a> <a class="idref" href="Matrix.html#x"><span class="id" title="variable">x</span></a>)^*.<br/>
</div>

<div class="doc">
We can derive the dot product and its complex analogue, the 
    <i>inner product</i>, from matrix multiplication. 
</div>
<div class="code code-tight">

<span class="id" title="keyword">Definition</span> <a name="dot"><span class="id" title="definition">dot</span></a> {<span class="id" title="variable">n</span> : <a class="idref" href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>} (<span class="id" title="variable">A</span> : <a class="idref" href="Matrix.html#Vector"><span class="id" title="abbreviation">Vector</span></a> <a class="idref" href="Matrix.html#n"><span class="id" title="variable">n</span></a>) (<span class="id" title="variable">B</span> : <a class="idref" href="Matrix.html#Vector"><span class="id" title="abbreviation">Vector</span></a> <a class="idref" href="Matrix.html#n"><span class="id" title="variable">n</span></a>) : <a class="idref" href="Complex.html#C"><span class="id" title="definition">C</span></a> :=<br/>
&nbsp;&nbsp;<a class="idref" href="Matrix.html#Mmult"><span class="id" title="definition">Mmult</span></a> (<a class="idref" href="Matrix.html#transpose"><span class="id" title="definition">transpose</span></a> <a class="idref" href="Matrix.html#A"><span class="id" title="variable">A</span></a>) <a class="idref" href="Matrix.html#B"><span class="id" title="variable">B</span></a> 0 0.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Definition</span> <a name="inner_product"><span class="id" title="definition">inner_product</span></a> {<span class="id" title="variable">n</span>} (<span class="id" title="variable">u</span> <span class="id" title="variable">v</span> : <a class="idref" href="Matrix.html#Vector"><span class="id" title="abbreviation">Vector</span></a> <a class="idref" href="Matrix.html#n"><span class="id" title="variable">n</span></a>) : <a class="idref" href="Complex.html#C"><span class="id" title="definition">C</span></a> := <br/>
&nbsp;&nbsp;<a class="idref" href="Matrix.html#Mmult"><span class="id" title="definition">Mmult</span></a> (<a class="idref" href="Matrix.html#adjoint"><span class="id" title="definition">adjoint</span></a> <a class="idref" href="Matrix.html#u"><span class="id" title="variable">u</span></a>) (<a class="idref" href="Matrix.html#v"><span class="id" title="variable">v</span></a>) 0 0.<br/>
</div>

<div class="doc">
The <i>outer product</i> produces a square matrix from two vectors. 
</div>
<div class="code code-tight">

<span class="id" title="keyword">Definition</span> <a name="outer_product"><span class="id" title="definition">outer_product</span></a> {<span class="id" title="variable">n</span>} (<span class="id" title="variable">u</span> <span class="id" title="variable">v</span> : <a class="idref" href="Matrix.html#Vector"><span class="id" title="abbreviation">Vector</span></a> <a class="idref" href="Matrix.html#n"><span class="id" title="variable">n</span></a>) : <a class="idref" href="Matrix.html#Square"><span class="id" title="abbreviation">Square</span></a> <a class="idref" href="Matrix.html#n"><span class="id" title="variable">n</span></a> := <br/>
&nbsp;&nbsp;<a class="idref" href="Matrix.html#Mmult"><span class="id" title="definition">Mmult</span></a> <a class="idref" href="Matrix.html#u"><span class="id" title="variable">u</span></a> (<a class="idref" href="Matrix.html#adjoint"><span class="id" title="definition">adjoint</span></a> <a class="idref" href="Matrix.html#v"><span class="id" title="variable">v</span></a>).<br/><hr class='doublespaceincode'/>
<span class="id" title="variable">Close</span> <span class="id" title="keyword">Scope</span> <span class="id" title="variable">nat_scope</span>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Infix</span> "×" := <a class="idref" href="Matrix.html#Mmult"><span class="id" title="definition">Mmult</span></a> (<span class="id" title="tactic">at</span> <span class="id" title="variable">level</span> 40, <span class="id" title="variable">left</span> <span class="id" title="variable">associativity</span>) : <span class="id" title="variable">matrix_scope</span>.<br/>
<span class="id" title="keyword">Infix</span> "⊗" := <a class="idref" href="Matrix.html#kron"><span class="id" title="definition">kron</span></a> (<span class="id" title="tactic">at</span> <span class="id" title="variable">level</span> 40, <span class="id" title="variable">left</span> <span class="id" title="variable">associativity</span>) : <span class="id" title="variable">matrix_scope</span>.<br/>
<span class="id" title="keyword">Notation</span> "A ⊤" := (<a class="idref" href="Matrix.html#transpose"><span class="id" title="definition">transpose</span></a> <span class="id" title="variable">A</span>) (<span class="id" title="tactic">at</span> <span class="id" title="variable">level</span> 0) : <span class="id" title="variable">matrix_scope</span>.<br/>
<span class="id" title="keyword">Notation</span> "A †" := (<a class="idref" href="Matrix.html#adjoint"><span class="id" title="definition">adjoint</span></a> <span class="id" title="variable">A</span>) (<span class="id" title="tactic">at</span> <span class="id" title="variable">level</span> 0) : <span class="id" title="variable">matrix_scope</span>.<br/>
<span class="id" title="keyword">Infix</span> "∘" := <a class="idref" href="Matrix.html#dot"><span class="id" title="definition">dot</span></a> (<span class="id" title="tactic">at</span> <span class="id" title="variable">level</span> 40, <span class="id" title="variable">left</span> <span class="id" title="variable">associativity</span>) : <span class="id" title="variable">matrix_scope</span>.<br/>
<span class="id" title="keyword">Notation</span> "⟨ A , B ⟩" := (<a class="idref" href="Matrix.html#inner_product"><span class="id" title="definition">inner_product</span></a> <span class="id" title="variable">A</span> <span class="id" title="variable">B</span>) : <span class="id" title="variable">matrix_scope</span>.<br/>
</div>

<div class="doc">
<a name="lab17"></a><h2 class="section">Compatibility lemmas</h2>

</div>
<div class="code code-space">

<br/>
<span class="id" title="keyword">Lemma</span> <a name="trace_compat"><span class="id" title="lemma">trace_compat</span></a> : <span style='font-size:120%;'>&forall;</span>{<span class="id" title="variable">n</span>} (<span class="id" title="variable">A</span> <span class="id" title="variable">A'</span> : <a class="idref" href="Matrix.html#Square"><span class="id" title="abbreviation">Square</span></a> <a class="idref" href="Matrix.html#n"><span class="id" title="variable">n</span></a>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Matrix.html#A"><span class="id" title="variable">A</span></a> == <a class="idref" href="Matrix.html#A'"><span class="id" title="variable">A'</span></a> → <a class="idref" href="Matrix.html#trace"><span class="id" title="definition">trace</span></a> <a class="idref" href="Matrix.html#A"><span class="id" title="variable">A</span></a> = <a class="idref" href="Matrix.html#trace"><span class="id" title="definition">trace</span></a> <a class="idref" href="Matrix.html#A'"><span class="id" title="variable">A'</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="variable">n</span> <span class="id" title="variable">A</span> <span class="id" title="variable">A'</span> <span class="id" title="variable">H</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="Complex.html#Csum_eq"><span class="id" title="lemma">Csum_eq</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="variable">x</span> <span class="id" title="variable">Hx</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="variable">H</span>; <span class="id" title="variable">easy</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Add</span> <span class="id" title="variable">Parametric</span> <span class="id" title="variable">Morphism</span> <span class="id" title="variable">n</span> : (@<a class="idref" href="Matrix.html#trace"><span class="id" title="definition">trace</span></a> <a class="idref" href="Matrix.html#n"><span class="id" title="variable">n</span></a>)<br/>
&nbsp;&nbsp;<span class="id" title="keyword">with</span> <span class="id" title="variable">signature</span> <a class="idref" href="Matrix.html#mat_equiv"><span class="id" title="definition">mat_equiv</span></a> ==&gt; <a class="idref" href="http://coq.inria.fr/library/Coq.Init.Logic.html#eq"><span class="id" title="inductive">eq</span></a> <span class="id" title="keyword">as</span> <span class="id" title="variable">trace_mor</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span>; <span class="id" title="tactic">apply</span> <a class="idref" href="Matrix.html#trace_compat"><span class="id" title="lemma">trace_compat</span></a>; <span class="id" title="variable">easy</span>. <span class="id" title="keyword">Qed</span>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Lemma</span> <a name="Mmult_compat"><span class="id" title="lemma">Mmult_compat</span></a> : <span style='font-size:120%;'>&forall;</span>{<span class="id" title="variable">m</span> <span class="id" title="variable">n</span> <span class="id" title="variable">o</span>} (<span class="id" title="variable">A</span> <span class="id" title="variable">A'</span> : <a class="idref" href="Matrix.html#Matrix"><span class="id" title="definition">Matrix</span></a> <a class="idref" href="Matrix.html#m"><span class="id" title="variable">m</span></a> <a class="idref" href="Matrix.html#n"><span class="id" title="variable">n</span></a>) (<span class="id" title="variable">B</span> <span class="id" title="variable">B'</span> : <a class="idref" href="Matrix.html#Matrix"><span class="id" title="definition">Matrix</span></a> <a class="idref" href="Matrix.html#n"><span class="id" title="variable">n</span></a> <a class="idref" href="Matrix.html#o"><span class="id" title="variable">o</span></a>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Matrix.html#A"><span class="id" title="variable">A</span></a> == <a class="idref" href="Matrix.html#A'"><span class="id" title="variable">A'</span></a> → <a class="idref" href="Matrix.html#B"><span class="id" title="variable">B</span></a> == <a class="idref" href="Matrix.html#B'"><span class="id" title="variable">B'</span></a> → <a class="idref" href="Matrix.html#A"><span class="id" title="variable">A</span></a> × <a class="idref" href="Matrix.html#B"><span class="id" title="variable">B</span></a> == <a class="idref" href="Matrix.html#A'"><span class="id" title="variable">A'</span></a> × <a class="idref" href="Matrix.html#B'"><span class="id" title="variable">B'</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="variable">m</span> <span class="id" title="variable">n</span> <span class="id" title="variable">o</span> <span class="id" title="variable">A</span> <span class="id" title="variable">A'</span> <span class="id" title="variable">B</span> <span class="id" title="variable">B'</span> <span class="id" title="variable">HA</span> <span class="id" title="variable">HB</span> <span class="id" title="variable">i</span> <span class="id" title="variable">j</span> <span class="id" title="variable">Hi</span> <span class="id" title="variable">Hj</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="Matrix.html#Mmult"><span class="id" title="definition">Mmult</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="Complex.html#Csum_eq"><span class="id" title="lemma">Csum_eq</span></a>; <span class="id" title="tactic">intros</span> <span class="id" title="variable">x</span> <span class="id" title="variable">Hx</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="variable">HA</span>, <span class="id" title="variable">HB</span>; <span class="id" title="variable">easy</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Add</span> <span class="id" title="variable">Parametric</span> <span class="id" title="variable">Morphism</span> <span class="id" title="variable">m</span> <span class="id" title="variable">n</span> <span class="id" title="variable">o</span> : (@<a class="idref" href="Matrix.html#Mmult"><span class="id" title="definition">Mmult</span></a> <a class="idref" href="Matrix.html#m"><span class="id" title="variable">m</span></a> <a class="idref" href="Matrix.html#n"><span class="id" title="variable">n</span></a> <a class="idref" href="Matrix.html#o"><span class="id" title="variable">o</span></a>)<br/>
&nbsp;&nbsp;<span class="id" title="keyword">with</span> <span class="id" title="variable">signature</span> <a class="idref" href="Matrix.html#mat_equiv"><span class="id" title="definition">mat_equiv</span></a> ==&gt; <a class="idref" href="Matrix.html#mat_equiv"><span class="id" title="definition">mat_equiv</span></a> ==&gt; <a class="idref" href="Matrix.html#mat_equiv"><span class="id" title="definition">mat_equiv</span></a> <span class="id" title="keyword">as</span> <span class="id" title="variable">Mmult_mor</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">apply</span> <a class="idref" href="Matrix.html#Mmult_compat"><span class="id" title="lemma">Mmult_compat</span></a>; <span class="id" title="variable">easy</span>. <span class="id" title="keyword">Qed</span>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Lemma</span> <a name="kron_compat"><span class="id" title="lemma">kron_compat</span></a> : <span style='font-size:120%;'>&forall;</span>{<span class="id" title="variable">m</span> <span class="id" title="variable">n</span> <span class="id" title="variable">o</span> <span class="id" title="variable">p</span>} (<span class="id" title="variable">A</span> <span class="id" title="variable">A'</span> : <a class="idref" href="Matrix.html#Matrix"><span class="id" title="definition">Matrix</span></a> <a class="idref" href="Matrix.html#m"><span class="id" title="variable">m</span></a> <a class="idref" href="Matrix.html#n"><span class="id" title="variable">n</span></a>) (<span class="id" title="variable">B</span> <span class="id" title="variable">B'</span> : <a class="idref" href="Matrix.html#Matrix"><span class="id" title="definition">Matrix</span></a> <a class="idref" href="Matrix.html#o"><span class="id" title="variable">o</span></a> <a class="idref" href="Matrix.html#p"><span class="id" title="variable">p</span></a>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Matrix.html#A"><span class="id" title="variable">A</span></a> == <a class="idref" href="Matrix.html#A'"><span class="id" title="variable">A'</span></a> → <a class="idref" href="Matrix.html#B"><span class="id" title="variable">B</span></a> == <a class="idref" href="Matrix.html#B'"><span class="id" title="variable">B'</span></a> → <a class="idref" href="Matrix.html#A"><span class="id" title="variable">A</span></a> ⊗ <a class="idref" href="Matrix.html#B"><span class="id" title="variable">B</span></a> == <a class="idref" href="Matrix.html#A'"><span class="id" title="variable">A'</span></a> ⊗ <a class="idref" href="Matrix.html#B'"><span class="id" title="variable">B'</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="variable">m</span> <span class="id" title="variable">n</span> <span class="id" title="variable">o</span> <span class="id" title="variable">p</span> <span class="id" title="variable">A</span> <span class="id" title="variable">A'</span> <span class="id" title="variable">B</span> <span class="id" title="variable">B'</span> <span class="id" title="variable">HA</span> <span class="id" title="variable">HB</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="variable">i</span> <span class="id" title="variable">j</span> <span class="id" title="variable">Hi</span> <span class="id" title="variable">Hj</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="Matrix.html#kron"><span class="id" title="definition">kron</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="variable">Ho</span> : <span class="id" title="variable">o</span> ≠ <a class="idref" href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#O"><span class="id" title="constructor">O</span></a>). <span class="id" title="tactic">intros</span> <span class="id" title="variable">F</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="variable">F</span> <span class="id" title="keyword">in</span> *. <span class="id" title="variable">lia</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="variable">Hp</span> : <span class="id" title="variable">p</span> ≠ <a class="idref" href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#O"><span class="id" title="constructor">O</span></a>). <span class="id" title="tactic">intros</span> <span class="id" title="variable">F</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="variable">F</span> <span class="id" title="keyword">in</span> *. <span class="id" title="variable">lia</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="variable">HA</span>, <span class="id" title="variable">HB</span>. <span class="id" title="variable">easy</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/library/Coq.Arith.PeanoNat.html#Nat.mod_upper_bound"><span class="id" title="lemma">Nat.mod_upper_bound</span></a>; <span class="id" title="variable">easy</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/library/Coq.Arith.PeanoNat.html#Nat.mod_upper_bound"><span class="id" title="lemma">Nat.mod_upper_bound</span></a>; <span class="id" title="variable">easy</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/library/Coq.Arith.PeanoNat.html#Nat.div_lt_upper_bound"><span class="id" title="lemma">Nat.div_lt_upper_bound</span></a>; <span class="id" title="variable">lia</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/library/Coq.Arith.PeanoNat.html#Nat.div_lt_upper_bound"><span class="id" title="lemma">Nat.div_lt_upper_bound</span></a>; <span class="id" title="variable">lia</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Add</span> <span class="id" title="variable">Parametric</span> <span class="id" title="variable">Morphism</span> <span class="id" title="variable">m</span> <span class="id" title="variable">n</span> <span class="id" title="variable">o</span> <span class="id" title="variable">p</span> : (@<a class="idref" href="Matrix.html#kron"><span class="id" title="definition">kron</span></a> <a class="idref" href="Matrix.html#m"><span class="id" title="variable">m</span></a> <a class="idref" href="Matrix.html#n"><span class="id" title="variable">n</span></a> <a class="idref" href="Matrix.html#o"><span class="id" title="variable">o</span></a> <a class="idref" href="Matrix.html#p"><span class="id" title="variable">p</span></a>)<br/>
&nbsp;&nbsp;<span class="id" title="keyword">with</span> <span class="id" title="variable">signature</span> <a class="idref" href="Matrix.html#mat_equiv"><span class="id" title="definition">mat_equiv</span></a> ==&gt; <a class="idref" href="Matrix.html#mat_equiv"><span class="id" title="definition">mat_equiv</span></a> ==&gt; <a class="idref" href="Matrix.html#mat_equiv"><span class="id" title="definition">mat_equiv</span></a> <span class="id" title="keyword">as</span> <span class="id" title="variable">kron_mor</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">apply</span> <a class="idref" href="Matrix.html#kron_compat"><span class="id" title="lemma">kron_compat</span></a>; <span class="id" title="variable">easy</span>. <span class="id" title="keyword">Qed</span>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Lemma</span> <a name="transpose_compat"><span class="id" title="lemma">transpose_compat</span></a> : <span style='font-size:120%;'>&forall;</span>{<span class="id" title="variable">m</span> <span class="id" title="variable">n</span>} (<span class="id" title="variable">A</span> <span class="id" title="variable">A'</span> : <a class="idref" href="Matrix.html#Matrix"><span class="id" title="definition">Matrix</span></a> <a class="idref" href="Matrix.html#m"><span class="id" title="variable">m</span></a> <a class="idref" href="Matrix.html#n"><span class="id" title="variable">n</span></a>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Matrix.html#A"><span class="id" title="variable">A</span></a> == <a class="idref" href="Matrix.html#A'"><span class="id" title="variable">A'</span></a> → <a class="idref" href="Matrix.html#A"><span class="id" title="variable">A</span></a>⊤ == <a class="idref" href="Matrix.html#A'"><span class="id" title="variable">A'</span></a>⊤.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="variable">m</span> <span class="id" title="variable">n</span> <span class="id" title="variable">A</span> <span class="id" title="variable">A'</span> <span class="id" title="variable">H</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="variable">i</span> <span class="id" title="variable">j</span> <span class="id" title="variable">Hi</span> <span class="id" title="variable">Hj</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="Matrix.html#transpose"><span class="id" title="definition">transpose</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="variable">H</span>; <span class="id" title="variable">easy</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Add</span> <span class="id" title="variable">Parametric</span> <span class="id" title="variable">Morphism</span> <span class="id" title="variable">m</span> <span class="id" title="variable">n</span> : (@<a class="idref" href="Matrix.html#transpose"><span class="id" title="definition">transpose</span></a> <a class="idref" href="Matrix.html#m"><span class="id" title="variable">m</span></a> <a class="idref" href="Matrix.html#n"><span class="id" title="variable">n</span></a>)<br/>
&nbsp;&nbsp;<span class="id" title="keyword">with</span> <span class="id" title="variable">signature</span> <a class="idref" href="Matrix.html#mat_equiv"><span class="id" title="definition">mat_equiv</span></a> ==&gt; <a class="idref" href="Matrix.html#mat_equiv"><span class="id" title="definition">mat_equiv</span></a> <span class="id" title="keyword">as</span> <span class="id" title="variable">transpose_mor</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">apply</span> <a class="idref" href="Matrix.html#transpose_compat"><span class="id" title="lemma">transpose_compat</span></a>; <span class="id" title="variable">easy</span>. <span class="id" title="keyword">Qed</span>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Lemma</span> <a name="adjoint_compat"><span class="id" title="lemma">adjoint_compat</span></a> : <span style='font-size:120%;'>&forall;</span>{<span class="id" title="variable">m</span> <span class="id" title="variable">n</span>} (<span class="id" title="variable">A</span> <span class="id" title="variable">A'</span> : <a class="idref" href="Matrix.html#Matrix"><span class="id" title="definition">Matrix</span></a> <a class="idref" href="Matrix.html#m"><span class="id" title="variable">m</span></a> <a class="idref" href="Matrix.html#n"><span class="id" title="variable">n</span></a>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Matrix.html#A"><span class="id" title="variable">A</span></a> == <a class="idref" href="Matrix.html#A'"><span class="id" title="variable">A'</span></a> → <a class="idref" href="Matrix.html#A"><span class="id" title="variable">A</span></a>† == <a class="idref" href="Matrix.html#A'"><span class="id" title="variable">A'</span></a>†.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="variable">m</span> <span class="id" title="variable">n</span> <span class="id" title="variable">A</span> <span class="id" title="variable">A'</span> <span class="id" title="variable">H</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="variable">i</span> <span class="id" title="variable">j</span> <span class="id" title="variable">Hi</span> <span class="id" title="variable">Hj</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="Matrix.html#adjoint"><span class="id" title="definition">adjoint</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="variable">H</span>; <span class="id" title="variable">easy</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Add</span> <span class="id" title="variable">Parametric</span> <span class="id" title="variable">Morphism</span> <span class="id" title="variable">m</span> <span class="id" title="variable">n</span> : (@<a class="idref" href="Matrix.html#adjoint"><span class="id" title="definition">adjoint</span></a> <a class="idref" href="Matrix.html#m"><span class="id" title="variable">m</span></a> <a class="idref" href="Matrix.html#n"><span class="id" title="variable">n</span></a>)<br/>
&nbsp;&nbsp;<span class="id" title="keyword">with</span> <span class="id" title="variable">signature</span> <a class="idref" href="Matrix.html#mat_equiv"><span class="id" title="definition">mat_equiv</span></a> ==&gt; <a class="idref" href="Matrix.html#mat_equiv"><span class="id" title="definition">mat_equiv</span></a> <span class="id" title="keyword">as</span> <span class="id" title="variable">adjoint_mor</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">apply</span> <a class="idref" href="Matrix.html#adjoint_compat"><span class="id" title="lemma">adjoint_compat</span></a>; <span class="id" title="variable">easy</span>. <span class="id" title="keyword">Qed</span>.<br/>
</div>

<div class="doc">
<a name="lab18"></a><h1 class="section">Matrix Properties</h1>

</div>
<div class="code code-space">

<br/>
<span class="id" title="keyword">Theorem</span> <a name="Mmult_assoc"><span class="id" title="lemma">Mmult_assoc</span></a> : <span style='font-size:120%;'>&forall;</span>{<span class="id" title="variable">m</span> <span class="id" title="variable">n</span> <span class="id" title="variable">o</span> <span class="id" title="variable">p</span> : <a class="idref" href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>} (<span class="id" title="variable">A</span> : <a class="idref" href="Matrix.html#Matrix"><span class="id" title="definition">Matrix</span></a> <a class="idref" href="Matrix.html#m"><span class="id" title="variable">m</span></a> <a class="idref" href="Matrix.html#n"><span class="id" title="variable">n</span></a>) (<span class="id" title="variable">B</span> : <a class="idref" href="Matrix.html#Matrix"><span class="id" title="definition">Matrix</span></a> <a class="idref" href="Matrix.html#n"><span class="id" title="variable">n</span></a> <a class="idref" href="Matrix.html#o"><span class="id" title="variable">o</span></a>) <br/>
&nbsp;&nbsp;(<span class="id" title="variable">C</span>: <a class="idref" href="Matrix.html#Matrix"><span class="id" title="definition">Matrix</span></a> <a class="idref" href="Matrix.html#o"><span class="id" title="variable">o</span></a> <a class="idref" href="Matrix.html#p"><span class="id" title="variable">p</span></a>), <a class="idref" href="Matrix.html#A"><span class="id" title="variable">A</span></a> × <a class="idref" href="Matrix.html#B"><span class="id" title="variable">B</span></a> × <a class="idref" href="Matrix.html#C"><span class="id" title="variable">C</span></a> == <a class="idref" href="Matrix.html#A"><span class="id" title="variable">A</span></a> × (<a class="idref" href="Matrix.html#B"><span class="id" title="variable">B</span></a> × <a class="idref" href="Matrix.html#C"><span class="id" title="variable">C</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="variable">m</span> <span class="id" title="variable">n</span> <span class="id" title="variable">o</span> <span class="id" title="variable">p</span> <span class="id" title="variable">A</span> <span class="id" title="variable">B</span> <span class="id" title="variable">C</span> <span class="id" title="variable">i</span> <span class="id" title="variable">j</span> <span class="id" title="variable">Hi</span> <span class="id" title="variable">Hj</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="Matrix.html#Mmult"><span class="id" title="definition">Mmult</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="variable">n</span>.<br/>
&nbsp;&nbsp;+ <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">clear</span> <span class="id" title="variable">B</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="variable">o</span>. <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="variable">IHo</span>. <span class="id" title="variable">lca</span>.<br/>
&nbsp;&nbsp;+ <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="variable">IHn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="Complex.html#Csum_mult_l"><span class="id" title="lemma">Csum_mult_l</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <a class="idref" href="Complex.html#Csum_plus"><span class="id" title="lemma">Csum_plus</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="Complex.html#Csum_eq"><span class="id" title="lemma">Csum_eq</span></a>; <span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="Complex.html#Cmult_plus_distr_r"><span class="id" title="lemma">Cmult_plus_distr_r</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="Complex.html#Cmult_assoc"><span class="id" title="lemma">Cmult_assoc</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">reflexivity</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Lemma</span> <a name="Mmult_adjoint"><span class="id" title="lemma">Mmult_adjoint</span></a> : <span style='font-size:120%;'>&forall;</span>{<span class="id" title="variable">m</span> <span class="id" title="variable">n</span> <span class="id" title="variable">o</span> : <a class="idref" href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>} (<span class="id" title="variable">A</span> : <a class="idref" href="Matrix.html#Matrix"><span class="id" title="definition">Matrix</span></a> <a class="idref" href="Matrix.html#m"><span class="id" title="variable">m</span></a> <a class="idref" href="Matrix.html#n"><span class="id" title="variable">n</span></a>) (<span class="id" title="variable">B</span> : <a class="idref" href="Matrix.html#Matrix"><span class="id" title="definition">Matrix</span></a> <a class="idref" href="Matrix.html#n"><span class="id" title="variable">n</span></a> <a class="idref" href="Matrix.html#o"><span class="id" title="variable">o</span></a>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="Matrix.html#A"><span class="id" title="variable">A</span></a> × <a class="idref" href="Matrix.html#B"><span class="id" title="variable">B</span></a>)† == <a class="idref" href="Matrix.html#B"><span class="id" title="variable">B</span></a>† × <a class="idref" href="Matrix.html#A"><span class="id" title="variable">A</span></a>†.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="variable">m</span> <span class="id" title="variable">n</span> <span class="id" title="variable">o</span> <span class="id" title="variable">A</span> <span class="id" title="variable">B</span> <span class="id" title="variable">i</span> <span class="id" title="variable">j</span> <span class="id" title="variable">Hi</span> <span class="id" title="variable">Hj</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="Matrix.html#Mmult"><span class="id" title="definition">Mmult</span></a>, <a class="idref" href="Matrix.html#adjoint"><span class="id" title="definition">adjoint</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="Complex.html#Csum_conj_distr"><span class="id" title="axiom">Csum_conj_distr</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="Complex.html#Csum_eq"><span class="id" title="lemma">Csum_eq</span></a>; <span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="Complex.html#Cconj_mult_distr"><span class="id" title="lemma">Cconj_mult_distr</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="Complex.html#Cmult_comm"><span class="id" title="lemma">Cmult_comm</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">reflexivity</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Lemma</span> <a name="Mmult_1_l"><span class="id" title="lemma">Mmult_1_l</span></a>: <span style='font-size:120%;'>&forall;</span>(<span class="id" title="variable">m</span> <span class="id" title="variable">n</span> : <a class="idref" href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>) (<span class="id" title="variable">A</span> : <a class="idref" href="Matrix.html#Matrix"><span class="id" title="definition">Matrix</span></a> <a class="idref" href="Matrix.html#m"><span class="id" title="variable">m</span></a> <a class="idref" href="Matrix.html#n"><span class="id" title="variable">n</span></a>), <br/>
&nbsp;&nbsp;<a class="idref" href="Matrix.html#I"><span class="id" title="definition">I</span></a> <a class="idref" href="Matrix.html#m"><span class="id" title="variable">m</span></a> × <a class="idref" href="Matrix.html#A"><span class="id" title="variable">A</span></a> == <a class="idref" href="Matrix.html#A"><span class="id" title="variable">A</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="variable">m</span> <span class="id" title="variable">n</span> <span class="id" title="variable">A</span> <span class="id" title="variable">i</span> <span class="id" title="variable">j</span> <span class="id" title="variable">Hi</span> <span class="id" title="variable">Hj</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="Matrix.html#Mmult"><span class="id" title="definition">Mmult</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="Complex.html#Csum_unique"><span class="id" title="axiom">Csum_unique</span></a>. <span class="id" title="tactic">apply</span> <span class="id" title="variable">Hi</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="Matrix.html#I"><span class="id" title="definition">I</span></a>. <span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/library/Coq.Arith.PeanoNat.html#Nat.eqb_refl"><span class="id" title="lemma">Nat.eqb_refl</span></a>. <span class="id" title="variable">lca</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="variable">x</span> <span class="id" title="variable">Hx</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="Matrix.html#I"><span class="id" title="definition">I</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/library/Coq.Arith.PeanoNat.html#Nat.eqb_neq"><span class="id" title="lemma">Nat.eqb_neq</span></a> <span class="id" title="keyword">in</span> <span class="id" title="variable">Hx</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="variable">Hx</span>.<br/>
&nbsp;&nbsp;<span class="id" title="variable">lca</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Lemma</span> <a name="Mmult_1_r"><span class="id" title="lemma">Mmult_1_r</span></a>: <span style='font-size:120%;'>&forall;</span>(<span class="id" title="variable">m</span> <span class="id" title="variable">n</span> : <a class="idref" href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>) (<span class="id" title="variable">A</span> : <a class="idref" href="Matrix.html#Matrix"><span class="id" title="definition">Matrix</span></a> <a class="idref" href="Matrix.html#m"><span class="id" title="variable">m</span></a> <a class="idref" href="Matrix.html#n"><span class="id" title="variable">n</span></a>), <br/>
&nbsp;&nbsp;<a class="idref" href="Matrix.html#A"><span class="id" title="variable">A</span></a> × <a class="idref" href="Matrix.html#I"><span class="id" title="definition">I</span></a> <a class="idref" href="Matrix.html#n"><span class="id" title="variable">n</span></a> == <a class="idref" href="Matrix.html#A"><span class="id" title="variable">A</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="variable">m</span> <span class="id" title="variable">n</span> <span class="id" title="variable">A</span> <span class="id" title="variable">i</span> <span class="id" title="variable">j</span> <span class="id" title="variable">Hi</span> <span class="id" title="variable">Hj</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="Matrix.html#Mmult"><span class="id" title="definition">Mmult</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="Complex.html#Csum_unique"><span class="id" title="axiom">Csum_unique</span></a>. <span class="id" title="tactic">apply</span> <span class="id" title="variable">Hj</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="Matrix.html#I"><span class="id" title="definition">I</span></a>. <span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/library/Coq.Arith.PeanoNat.html#Nat.eqb_refl"><span class="id" title="lemma">Nat.eqb_refl</span></a>. <span class="id" title="variable">lca</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="variable">x</span> <span class="id" title="variable">Hx</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="Matrix.html#I"><span class="id" title="definition">I</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/library/Coq.Arith.PeanoNat.html#Nat.eqb_neq"><span class="id" title="lemma">Nat.eqb_neq</span></a> <span class="id" title="keyword">in</span> <span class="id" title="variable">Hx</span>. <span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/library/Coq.Arith.PeanoNat.html#Nat.eqb_sym"><span class="id" title="lemma">Nat.eqb_sym</span></a>. <span class="id" title="tactic">rewrite</span> <span class="id" title="variable">Hx</span>.<br/>
&nbsp;&nbsp;<span class="id" title="variable">lca</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Lemma</span> <a name="adjoint_involutive"><span class="id" title="lemma">adjoint_involutive</span></a> : <span style='font-size:120%;'>&forall;</span>{<span class="id" title="variable">m</span> <span class="id" title="variable">n</span>} (<span class="id" title="variable">A</span> : <a class="idref" href="Matrix.html#Matrix"><span class="id" title="definition">Matrix</span></a> <a class="idref" href="Matrix.html#m"><span class="id" title="variable">m</span></a> <a class="idref" href="Matrix.html#n"><span class="id" title="variable">n</span></a>), <a class="idref" href="Matrix.html#A"><span class="id" title="variable">A</span></a>†† == <a class="idref" href="Matrix.html#A"><span class="id" title="variable">A</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;WORKED&nbsp;IN&nbsp;CLASS&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="variable">m</span> <span class="id" title="variable">n</span> <span class="id" title="variable">A</span> <span class="id" title="variable">i</span> <span class="id" title="variable">j</span> <span class="id" title="variable">_</span> <span class="id" title="variable">_</span>.<br/>
&nbsp;&nbsp;<span class="id" title="variable">lca</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Lemma</span> <a name="kron_adjoint"><span class="id" title="lemma">kron_adjoint</span></a> : <span style='font-size:120%;'>&forall;</span>{<span class="id" title="variable">m</span> <span class="id" title="variable">n</span> <span class="id" title="variable">o</span> <span class="id" title="variable">p</span>} (<span class="id" title="variable">A</span> : <a class="idref" href="Matrix.html#Matrix"><span class="id" title="definition">Matrix</span></a> <a class="idref" href="Matrix.html#m"><span class="id" title="variable">m</span></a> <a class="idref" href="Matrix.html#n"><span class="id" title="variable">n</span></a>) (<span class="id" title="variable">B</span> : <a class="idref" href="Matrix.html#Matrix"><span class="id" title="definition">Matrix</span></a> <a class="idref" href="Matrix.html#o"><span class="id" title="variable">o</span></a> <a class="idref" href="Matrix.html#p"><span class="id" title="variable">p</span></a>),<br/>
&nbsp;&nbsp;(<a class="idref" href="Matrix.html#A"><span class="id" title="variable">A</span></a> ⊗ <a class="idref" href="Matrix.html#B"><span class="id" title="variable">B</span></a>)† == <a class="idref" href="Matrix.html#A"><span class="id" title="variable">A</span></a>† ⊗ <a class="idref" href="Matrix.html#B"><span class="id" title="variable">B</span></a>†.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;WORKED&nbsp;IN&nbsp;CLASS&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="variable">m</span> <span class="id" title="variable">n</span> <span class="id" title="variable">o</span> <span class="id" title="variable">p</span> <span class="id" title="variable">A</span> <span class="id" title="variable">B</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="variable">i</span> <span class="id" title="variable">j</span> <span class="id" title="variable">Hi</span> <span class="id" title="variable">Hj</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="Matrix.html#adjoint"><span class="id" title="definition">adjoint</span></a>, <a class="idref" href="Matrix.html#kron"><span class="id" title="definition">kron</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="Complex.html#Cconj_mult_distr"><span class="id" title="lemma">Cconj_mult_distr</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">reflexivity</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>
</div>

<div class="doc">
<a name="lab19"></a><h1 class="section">Matrix Automation</h1>

<div class="paragraph"> </div>

 A useful tactic for solving A == B for concrete A, B 
</div>
<div class="code code-tight">

<span class="id" title="keyword">Ltac</span> <span class="id" title="variable">solve_end</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="variable">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <span class="id" title="variable">H</span> : <a class="idref" href="http://coq.inria.fr/library/Coq.Init.Peano.html#lt"><span class="id" title="definition">lt</span></a> <span class="id" title="variable">_</span> <a class="idref" href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#O"><span class="id" title="constructor">O</span></a> &#x22A2; <span class="id" title="variable">_</span> ⇒ <span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/library/Coq.Arith.PeanoNat.html#Nat.nlt_0_r"><span class="id" title="lemma">Nat.nlt_0_r</span></a> <span class="id" title="keyword">in</span> <span class="id" title="variable">H</span>; <span class="id" title="variable">contradict</span> <span class="id" title="variable">H</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Ltac</span> <span class="id" title="variable">by_cell</span> := <br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="variable">i</span> <span class="id" title="variable">j</span> <span class="id" title="variable">Hi</span> <span class="id" title="variable">Hj</span>;<br/>
&nbsp;&nbsp;<span class="id" title="tactic">repeat</span> (<span class="id" title="tactic">destruct</span> <span class="id" title="variable">i</span> <span class="id" title="keyword">as</span> [|<span class="id" title="variable">i</span>]; <span class="id" title="tactic">simpl</span>; [|<span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/library/Coq.Arith.Lt.html#lt_S_n"><span class="id" title="lemma">lt_S_n</span></a> <span class="id" title="keyword">in</span> <span class="id" title="variable">Hi</span>]; <span class="id" title="tactic">try</span> <span class="id" title="variable">solve_end</span>); <span class="id" title="tactic">clear</span> <span class="id" title="variable">Hi</span>;<br/>
&nbsp;&nbsp;<span class="id" title="tactic">repeat</span> (<span class="id" title="tactic">destruct</span> <span class="id" title="variable">j</span> <span class="id" title="keyword">as</span> [|<span class="id" title="variable">j</span>]; <span class="id" title="tactic">simpl</span>; [|<span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/library/Coq.Arith.Lt.html#lt_S_n"><span class="id" title="lemma">lt_S_n</span></a> <span class="id" title="keyword">in</span> <span class="id" title="variable">Hj</span>]; <span class="id" title="tactic">try</span> <span class="id" title="variable">solve_end</span>); <span class="id" title="tactic">clear</span> <span class="id" title="variable">Hj</span>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Ltac</span> <span class="id" title="variable">lma</span> := <span class="id" title="variable">by_cell</span>; <span class="id" title="variable">lca</span>.<br/>
</div>

<div class="doc">
Let's test it! 
</div>
<div class="code code-tight">
<span class="id" title="keyword">Lemma</span> <a name="scale0_concrete"><span class="id" title="lemma">scale0_concrete</span></a> : 0 .* <a class="idref" href="Matrix.html#I"><span class="id" title="definition">I</span></a> 10 == <a class="idref" href="Matrix.html#Zero"><span class="id" title="definition">Zero</span></a> <span class="id" title="variable">_</span> <span class="id" title="variable">_</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="variable">lma</span>. <span class="id" title="keyword">Qed</span>.<br/><hr class='doublespaceincode'/>

<br/><hr class='doublespaceincode'/>

<br/><hr class='doublespaceincode'/>
<span class="comment">(*&nbsp;Thu&nbsp;Aug&nbsp;1&nbsp;13:45:52&nbsp;EDT&nbsp;2019&nbsp;*)</span><br/>
</div>
</div>



</div>

</body>
</html>